# 基本設計方針書

## 1. 文書情報

- 文書ID: BD-01
- 文書名: 基本設計方針書
- 対象システム: 勤怠管理システム（Kintai）
- 版数: 0.1-draft
- 作成日: 2026-02-13
- 対象リポジトリ: `kintai`

## 2. 目的

本書は、Kintaiにおける基本設計の共通方針を定義し、後続の基本設計書（機能設計、API設計、DB設計、運用設計など）の判断基準を統一することを目的とする。

## 3. 適用範囲

本書の適用範囲は以下とする。

- フロントエンド（React + TypeScript）
- バックエンド（Go + Gin）
- データストア（PostgreSQL / Redis）
- インフラ（Docker Compose / AWS Terraform）
- 監視運用（Prometheus / OTel / ELK）
- 対象ドメイン
- 勤怠アプリ（`/attendance`, `/leaves`, `/overtime`, `/corrections`）
- 経費アプリ（`/expenses/*`）
- 人事アプリ（`/hr/*`）
- 社内Wiki（`/wiki/*`）

## 4. 非対象

以下は本書の直接対象外とし、必要時に別紙で定義する。

- プロダクトロードマップや事業KPIの策定
- 組織体制や人員計画の詳細
- 監査対応の運用手順詳細
- 利用規約・法務文書の正文

## 5. 設計前提

- アーキテクチャはモジュラーモノリスを採用する。
- backendは単一デプロイ単位とし、ドメイン別に責務分離する。
- `/api/v1` 配下の保護ルートはJWT認証を前提とする。
- DBスキーマ変更は migration を正とし、破壊的変更は段階移行で実施する。
- 仕様変更時は実装と同一PRでドキュメント更新を行う。

## 6. 基本設計原則

### 6.1 責務分離

- ルーティング、業務ロジック、永続化を明確に分離する。
- ドメイン境界を越える処理は shared レイヤーで明示的に扱う。

### 6.2 変更容易性

- 既存機能への影響範囲を限定できる構造を優先する。
- モジュール間インターフェースを明文化し、暗黙依存を避ける。

### 6.3 一貫性

- 命名、エラー形式、HTTPステータス、バリデーション基準を統一する。
- ロール制御と認可方針をAPI/画面で不整合なく定義する。

### 6.4 可観測性

- 障害時に追跡可能なログ・メトリクス・トレースを設計段階で定義する。
- ヘルスチェック、しきい値、アラート条件を運用設計に接続する。

### 6.5 セキュリティ

- 最小権限を原則とし、機密情報はコード外で管理する。
- 認証・認可・入力検証・レート制御を防御線として重ねる。

### 6.6 テスト容易性

- 仕様を検証可能な単位で設計する（unit/integration/E2E）。
- 正常系だけでなく異常系・境界値を先に定義する。

## 7. 品質特性方針

- 可用性: 障害時に限定影響で復旧できる構成とする。
- 性能: 主要APIの応答時間とスループットを計測可能に設計する。
- 拡張性: 新規ドメイン機能を既存境界内で追加できる構造を維持する。
- 保守性: 変更時に関連箇所と影響を追跡可能とする。

## 8. ドキュメント方針

- 基本設計書は「背景・目的・設計・判断理由・制約」を最低限含める。
- 実装ファクトに基づいて記述し、抽象論のみで終わらせない。
- 仕様の唯一参照元（SoT）を各文書に明記する。
- 文書間参照はID（例: BD-02, BD-03）で管理する。

## 9. 変更管理

- 版管理ルール
- major: 設計方針の破壊的変更
- minor: セクション追加・方針補強
- patch: 誤記修正・表現調整
- 変更時は、変更理由・影響範囲・関連文書を必ず記録する。

## 10. 関連文書（現行）

- `docs/wiki/ja/overview.md`
- `docs/wiki/ja/architecture.md`
- `docs/wiki/ja/backend.md`
- `docs/wiki/ja/frontend.md`
- `docs/wiki/ja/infrastructure.md`
- `docs/wiki/ja/testing.md`

## 11. 次文書

次に作成する基本設計書は BD-02「システムコンテキスト設計書」とする。
